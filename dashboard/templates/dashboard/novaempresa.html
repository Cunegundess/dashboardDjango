{% extends 'base.html' %}

{% block content %}
<div class="container">
    <form method="POST" id="formNovaEmpresa" onsubmit="submitForm(); return false;">
    {% csrf_token %}
        <div class="card mt-5 shadow rounded-1 w-100 d-flex flex-row mw-100">
            <div class="card-body d-flex flex-column gap-4">
                <div class="mb-3 w-100 flex-grow-1">
                    <label for="formGroupExampleInput" class="form-label">Empresa</label>
                    <input type="text" class="form-control" name="name" id="formGroupExampleInput" placeholder="Dois IrmÃ£os Inc.">
                </div>
                <div class="mb-3 w-100 flex-grow-1">
                    <label for="formGroupExampleInput" class="form-label">CNPJ</label>
                    <input type="text" class="form-control" name="Cnpj" id="cnpjInput" placeholder="00.000.000/0000-00">
                </div>
                <div class="mb-3 w-25">
                    <label for="id_active" class="form-label">Ativo</label>
                    <select id="id_active" name="active" class="form-select">
                        <option value="Ativo" {% if empresa.active == 'Ativo' %}selected{% endif %}>Ativo</option>
                        <option value="Inativo" {% if empresa.active == 'Inativo' %}selected{% endif %}>Inativo</option>              
                    </select>
                </div>
            </div>
        </div>
        
        <div class="sticky-bottom position-relative d-flex justify-content-between">
            <div class="mb-5 mt-4">
                <a href="/">
                    <button class="btn btn-danger btn-lg rounded-1" type="button">Voltar</button>
                </a>
            </div>
            <div class="mb-5 mt-4">
                <input class="btn btn-primary btn-lg rounded-1" type="submit" value="Salvar"></input>
            </div>
        </div>
    </form>
    
</div>
{% block scripts %}
<script>
function submitForm() {
    var form = $("#formNovaEmpresa")[0];
    var formData = new FormData(form);
    formData.append("csrfmiddlewaretoken", "{% csrf_token %}");
    $.ajax({
        url: "{% url 'novaEmpresa' %}",
        type: "POST",
        data: formData,
        processData: false,
        contentType: false,
        beforeSend: function(xhr, settings) {
            xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
        },
        success: function(response) {
            console.log(response);
        },
        error: function(xhr, status, error) {
            console.log(xhr.responseText);
            // handle error
        }
    });
}

</script>
{% endblock %}

{% endblock %}
